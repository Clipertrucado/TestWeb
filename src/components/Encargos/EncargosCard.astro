---
---

<div id="encargos-card" class="max-w-md p-6 mt-6 bg-white shadow-xl rounded-2xl">
    <h2 class="mb-4 text-xl font-semibold text-red-600">Encargos</h2>
    <ul id="encargos-list" class="space-y-2 text-gray-700 list-disc list-inside">
      <li>Cargando encargos...</li>
    </ul>
  
    <script is:inline type="module">
      import jwtDecode from 'https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.esm.js';
  
      const token = localStorage.getItem("token");
      const lista = document.getElementById("encargos-list");
  
      if (token && lista) {
        try {
          const decoded = jwtDecode(token);
          const userId = decoded.id;
  
          fetch(`http://localhost:4000/api/encargos/user/${userId}`)
            .then(res => res.json())
            .then(encargos => {
              if (!encargos.length) {
                lista.innerHTML = "<li class='text-gray-500'>No tienes encargos aún.</li>";
                return;
              }
  
              lista.innerHTML = "";
              for (const encargo of encargos) {
                const item = document.createElement("li");
                item.textContent = `${encargo.nombre_encargo} (${encargo.numero_preguntas_encargo} preguntas)`;
                lista.appendChild(item);
              }
            })
            .catch(err => {
              console.error("Error al cargar encargos:", err);
              lista.innerHTML = "<li class='text-red-500'>Error al cargar encargos.</li>";
            });
  
        } catch (e) {
          lista.innerHTML = "<li class='text-red-500'>Token inválido.</li>";
        }
      }
    </script>
  </div>
  